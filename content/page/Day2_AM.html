---
title: "Day 2 - AM"
output: 
  blogdown::html_page: 
    toc: true
    toc_depth: 1
    highlight: tango
    css: css/camp_style.css
    number_sections: true
    self_contained: false
    fontsize: 18pt
    monofont: Source Code Pro
---

<script src="/rmarkdown-libs/clipboard/clipboard.min.js"></script>
<link href="/rmarkdown-libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
<script src="/rmarkdown-libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
<script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
<link href="/rmarkdown-libs/font-awesome/css/all.css" rel="stylesheet" />
<link href="/rmarkdown-libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>
  <link rel="stylesheet" href="css/camp_style.css" type="text/css" />

<div id="TOC">
<ul>
<li><a href="#review---new-project" id="toc-review---new-project"><span class="toc-section-number">1</span> Review - New project</a></li>
<li><a href="#finn-needs-us" id="toc-finn-needs-us">Finn needs us!</a></li>
<li><a href="#jakku-re-visited" id="toc-jakku-re-visited"><span class="toc-section-number">2</span> Jakku re-visited</a></li>
<li><a href="#join-tables-with-left_join" id="toc-join-tables-with-left_join"><span class="toc-section-number">3</span> Join tables with <strong>left_join</strong></a></li>
<li><a href="#summarize" id="toc-summarize"><span class="toc-section-number">4</span> <code>summarize()</code></a></li>
<li><a href="#group_by-category" id="toc-group_by-category"><span class="toc-section-number">5</span> <code>group_by()</code> category</a></li>
<li><a href="#save-files" id="toc-save-files"><span class="toc-section-number">6</span> Save files</a></li>
<li><a href="#a-sickness-grows" id="toc-a-sickness-grows"><span class="toc-section-number">7</span> A sickness grows…</a></li>
</ul>
</div>

<style>
h1 .header-section-number {background: #62BE2C;}
hr {background: #62BE2C;}
</style>
<div id="good-morning-jedis" class="section level2 unnumbered">
<h2>Good morning, Jedis!</h2>
<hr class="hrlvl2">
<p><img src="../images/day2_bb8_sq.png" style="float: left; margin-right: 60px; margin-top: -10px;" width="260" /></p>
<div style="clear: both;">

</div>
</div>
<div id="review---new-project" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Review - New project</h1>
<hr>
<div id="new-data---new-project" class="section level2 unnumbered">
<h2>New data -&gt; New project!</h2>
<p>Below is an example workflow for an R project:</p>
<ol style="list-style-type: decimal">
<li>Create a new project</li>
<li>Read the data</li>
<li>Clean column names</li>
<li>Explore data
<ul>
<li>Plot the data</li>
</ul></li>
<li>Clean the data</li>
<li>View the data closer</li>
<li>Summarize the data</li>
<li>Save the results</li>
<li><strong>Share</strong> with friends</li>
</ol>
<p><br></p>
</div>
<div id="porg-review" class="section level2 unnumbered">
<h2>Porg review</h2>
<hr class="hrlvl2">
<p>The <em>poggle</em> of porgs has returned to help review the <code>dplyr</code> functions. Follow along by reading the <strong>porgs</strong> data from the URL below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>porgs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.com/data/porg_data.csv&quot;</span>)</span></code></pre></div>
<p><br></p>
<ul class="nav nav-pills" id="myTab" role="tablist" style="margin-top: 18px;">
<li class="nav-item active">
<a class="nav-link" id="porgs-tab" data-toggle="tab" href="#porgs" role="tab" aria-controls="porgs" aria-selected="true"> porgs </a>
</li>
<li class="nav-item">
<a class="nav-link" id="select-tab" data-toggle="tab" href="#select" role="tab" aria-controls="select" aria-selected="false"> <code>select</code> </a>
</li>
<li class="nav-item">
<a class="nav-link" id="arrange-tab" data-toggle="tab" href="#arrange" role="tab" aria-controls="arrange" aria-selected="false"> <code>arrange</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="filter3-tab" data-toggle="tab" href="#filter3" role="tab" aria-controls="filter3" aria-selected="false"> <code>filter</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="mutate3-tab" data-toggle="tab" href="#mutate3" role="tab" aria-controls="mutate3" aria-selected="false"> <code>mutate</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="summarize-tab" data-toggle="tab" href="#summarize" role="tab" aria-controls="summarize" aria-selected="false"> <code>summarize</code></a>
</li>
<li class="nav-item">
<a class="nav-link" id="group_by-tab" data-toggle="tab" href="#group_by" role="tab" aria-controls="group_by" aria-selected="false"> <code>group_by</code></a>
</li>
</ul>
<div id="myTabContent" class="well tab-content" style="background-color: white;">
<div id="porgs" class="tab-pane fade active in" role="tabpanel" aria-labelledby="porgs-tab">
<img src="../images/porgs/porgs_tbl.png" style="width: 85%;" /> <br><br>
</div>
<div id="select" class="tab-pane fade" role="tabpanel" aria-labelledby="select-tab">
<img src="../images/porgs/select_card.png" style="width: 90%;" /> <br><br> <img src="../images/porgs/select_drop_tbl.png" style="width: 82%;" /> <br><br>
</div>
<div id="arrange" class="tab-pane fade" role="tabpanel" aria-labelledby="arrange-tab">
<img src="../images/porgs/arrange_tbl.png" style="width: 98%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/arrange_tbl_desc.png" style="width: 98%;" /> <br><br>
</div>
<div id="filter3" class="tab-pane fade" role="tabpanel" aria-labelledby="filter3-tab">
<img src="../images/porgs/filter_card.png" style="width: 95%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/filter2_tbl.png" style="width: 95%;" /> <br><br>
</div>
<div id="mutate3" class="tab-pane fade" role="tabpanel" aria-labelledby="mutate3-tab">
<img src="../images/porgs/mutate_card.png" style="width: 98%; margin-top: 12px;" /> <br><br>
</div>
<div id="summarize" class="tab-pane fade" role="tabpanel" aria-labelledby="summarize-tab">
<img src="../images/porgs/summarize_card.png" style="width: 98%;" /> <br><br>
</div>
<div id="group_by" class="tab-pane fade" role="tabpanel" aria-labelledby="group_by-tab">
<img src="../images/porgs/groupby_tbl.png" style="width: 92%; margin-top: 10px;" /> <br><br> <img src="../images/porgs/groupby_tbl2.png" style="width: 94%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/groupby_tbl3.png" style="width: 94%; margin-top: 12px;" /> <br><br> <img src="../images/porgs/groupby_tbl_final.png" style="width: 101%; margin-top: 12px;" />
</div>
</div>
<p><br></p>
<blockquote>
<h3 id="wait.-so-wheres-finn" class="unnumbered">Wait…. <strong>So where’s Finn?</strong></h3>
</blockquote>
</div>
</div>
<div id="finn-needs-us" class="section level1 unnumbered">
<h1>Finn needs us!</h1>
<p>Turn this ship around BB8, Finn needs us back on Jakku. We’re going to have to get better at our roll call procedure. Here we come Finn. <strong>Blast off!</strong></p>
<p><img src="../images/finn_run.gif" style="margin-left: 18%; width: 60%; margin-top: 6px;" /></p>
</div>
<div id="jakku-re-visited" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Jakku re-visited</h1>
<hr>
<p>Okay, so we’re back on this ol’ dust bucket planet. Let’s try not to forget anyone this time. Data droid, let me know if anyone goes missing.</p>
<div id="a-scrappy-ransom" class="section level2 unnumbered">
<h2>A scrappy ransom</h2>
<p>Mr. Baddy Plutt is demanding <strong>10,000 items</strong> of scrap for Finn. Sounds expensive, but lucky for us he didn’t clarify the exact items. Let’s find the scrap that weighs the least per shipment and try to make this transaction as light as possible.</p>
<div class="tip" style="margin-top: 28px; margin-bottom: 28px;">
<h3 style="margin-top: 8px;">
Update from BB8!
</h3>
<p>BB8 was busy on our flight back to Jakku, and recovered a <strong>full</strong> set of scrap records from the notorious Unkar Plutt. Let’s take a look.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the full scrap data</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.app/data/starwars_scrap_jakku_full.csv&quot;</span>)</span></code></pre></div>
</div>
<p>Take a look at the <strong>NEW</strong> scrap data and see if we have the weight of all the items.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What unit types are in the data?</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scrap<span class="sc">$</span>units)</span></code></pre></div>
<pre><code>## [1] &quot;Cubic Yards&quot; &quot;Items&quot;       &quot;Tons&quot;</code></pre>
<p><br></p>
<p><strong>Or return results as a data frame</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(scrap, units)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   units      
##   &lt;chr&gt;      
## 1 Cubic Yards
## 2 Items      
## 3 Tons</code></pre>
<p><br></p>
<p><em>Hmmm….</em> So how much does a cubic yard of <code>Hull Panel</code> weigh?</p>
<p><em>A lot? 32? Maybe…</em></p>
<p>I think we’re going to need some more data.</p>
<p><br></p>
</div>
<div id="weight-conversion" class="section level2 unnumbered">
<h2>Weight conversion</h2>
<p><img src="../images/rey_bb8.jpg" style="width: 35%; margin-top: 0px; margin-left: 15px; margin-right: 0px;" align="right" /></p>
<p>It took a while, but with a few droid bribes BB8 was able to track down a <em>Weight conversion table</em> from his droid buddies. Our current data shows the total cubic yards for some scrap shipments, but not how much the shipment weighs.</p>
<div id="read-the-weight-conversion-table" class="section level3 unnumbered">
<h3>Read the weight conversion table</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The data&#39;s URL</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>convert_url <span class="ot">&lt;-</span> <span class="st">&quot;https://mn-r.netlify.app/data/conversion_table.csv&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the conversion data</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>convert <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(convert_url)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(convert, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   item               units       pounds_per_unit
##   &lt;chr&gt;              &lt;chr&gt;                 &lt;dbl&gt;
## 1 Bulkhead           Cubic Yards             321
## 2 Hull Panel         Cubic Yards             641
## 3 Repulsorlift array Cubic Yards             467</code></pre>
<p><br></p>
<p>Oh my stars! A cubic yard of <code>Hull Panel</code> weighs <strong>641 lbs</strong>. I knew it!</p>
<p>Let’s join this new conversion table to the scrap data to make our calculations easier. To do that we need to meet a new function.</p>
<p><strong>Say Hello to our friend <code>left_join()</code>!</strong></p>
<p><br></p>
</div>
</div>
</div>
<div id="join-tables-with-left_join" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Join tables with <strong>left_join</strong></h1>
<hr>
<div id="joining-2-tables" class="section level2 unnumbered">
<h2>Joining 2 tables</h2>
<p><img src="../images/leftjoin_scrap.png" style="width: 55%; margin-left: 18%; margin-bottom: 12px;" /></p>
<blockquote>
<h4 id="left_joinscrap-convert-by-ccolumns-to-join-by" class="unnumbered"><code>left_join(scrap, convert, by = c("columns to join by"))</code></h4>
</blockquote>
<p><br></p>
<p>Left join works like a zipper to combine 2 tables based on one or more variables. It’s called “left”-join because the entire table on the left side is retained.</p>
<p>Anything that matches from the right table gets to join the party, but any rows that don’t have a matching ID will be ignored.</p>
<p><br></p>
<div id="adding-porg-names" class="section level3 unnumbered">
<h3>Adding porg names</h3>
<p>Remember our porg friends? How rude of us not to share their names.</p>
<p>Here’s a table of their names.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>porgs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.com/data/porg_data.csv&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>porg_names <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.com/data/porg_names.csv&quot;</span>)</span></code></pre></div>
<div style="margin-left: 30px; margin-top: 24px; width: 37%; max-width: 37%; margin-bottom: 22px;">
<p><img src="../images/porgs/porg_names_tbl.png" /></p>
</div>
<blockquote>
<p><strong>But who’s who?</strong> Let’s join their names to the rest of the data based on the <code>ID</code> column.</p>
</blockquote>
<p><img src="../images/porgs/leftjoin_porgs.png" style="width: 98%;" /></p>
<p><br></p>
</div>
<div id="the-joined-table" class="section level3 unnumbered">
<h3><strong>The joined table</strong></h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>named_porgs <span class="ot">&lt;-</span> <span class="fu">left_join</span>(porgs, porg_names, <span class="at">by =</span> <span class="st">&quot;id&quot;</span>)</span></code></pre></div>
<div class="well">
<p><img src="../images/porgs/named_porgs.png" style="width: 92%;" /></p>
</div>
<p><br></p>
<details>
<summary class="btn_code_blue">
<span style="color: #f6cd00;"><i class="fas fa-star"></i></span> <strong>More on joining tables</strong>
</summary>
<div class="note" style="margin-top: -2px;">
<p>
<div id="star-wars-characters" class="section level3 unnumbered">
<h3>Star Wars characters</h3>
<p><strong>left_join()</strong> adds columns to your table by pulling them from another table.</p>
<p>Imagine you have the two tables below.</p>
<ul>
<li>The left table has character names and heights</li>
<li>The right table has names and homeworlds.</li>
</ul>
<p>Since both tables share a common name column, we can join the tables together using the <code>name</code> column as the joining key.</p>
<style type="text/css"> 
.table {width: 30%;} 
</style>
<div style="float: left;">
<p><code>starwars_heights</code></p>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">height</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="right">202</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="left">Greedo</td>
<td align="right">246</td>
</tr>
</tbody>
</table>
</div>
<div style="float: left; margin-left: 15%;">
<p><code>starwars_homeworlds</code></p>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="left">Alderaan</td>
</tr>
<tr class="odd">
<td align="left">Ayla Secura</td>
<td align="left">Ryloth</td>
</tr>
</tbody>
</table>
</div>
<div style="clear: both;">

</div>
<p><br></p>
<p><strong>Uh oh.</strong> There’s no “Ayla Secura” in the height table and there’s no “Greedo” in the homeworlds table. Can we still join the tables? Run the code below to see what happens.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new tables </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>starwars_heights <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Greedo&quot;</span>), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">202</span>, <span class="dv">150</span>, <span class="dv">246</span>))      </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>starwars_homeworlds <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Ayla Secura&quot;</span>), </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">homeworld =</span> <span class="fu">c</span>(<span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Alderaan&quot;</span>, <span class="st">&quot;Ryloth&quot;</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Tell left_join which columns to use as the key with:  </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     by = c(&quot;key_left&quot; = &quot;key_right&quot;)</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>height_and_homeworld <span class="ot">&lt;-</span> <span class="fu">left_join</span>(starwars_heights, starwars_homeworlds, </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span> <span class="ot">=</span> <span class="st">&quot;name&quot;</span>))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>height_and_homeworld</span></code></pre></div>
<p><br></p>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">height</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="right">202</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="right">150</td>
<td align="left">Alderaan</td>
</tr>
<tr class="odd">
<td align="left">Greedo</td>
<td align="right">246</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="did-it-work" class="section level3 unnumbered">
<h3>Did it work?</h3>
<p>When <strong>left_join</strong> adds the <code>homeworlds</code> column to the <em>starwars_heights</em> table it only adds a value for the characters when the tables have a matching character name. When R couldn’t find “Greedo” in the homeworld table, the homeworld for that row was recorded as missing or <em><code>NA</code></em>.</p>
<p><br></p>
</div>
<div id="multiple-records" class="section level3 unnumbered">
<h3>Multiple records</h3>
<div>
<p><img src="../images/c3po.png" style="width: 13%; float: left; margin-top: 12px; margin-right: 4px;" /> <img src="../images/c3po.png" style="width: 13%; float: left; margin-top: 12px; margin-right: 28px;" /></p>
</div>
<p><br></p>
<p>Now imagine the table <code>starwars_homeworld</code> has two records for C-3PO, each with a different homeworld listed.</p>
<p>What will happen when you join the two tables?</p>
<div style="clear: both;">
<br>
</div>
<div style="float: left;">
<p><code>starwars_heights</code></p>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">height</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
</tr>
<tr class="odd">
<td align="left">Darth Vader</td>
<td align="right">202</td>
</tr>
<tr class="even">
<td align="left">Leia Organa</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="left">Greedo</td>
<td align="right">246</td>
</tr>
</tbody>
</table>
</div>
<div style="float: left; margin-left: 15%;">
<p><code>starwars_homeworlds</code></p>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">C-3PO</td>
<td align="left">Tantive IV</td>
</tr>
<tr class="even">
<td align="left">Darth Vader</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Leia Organa</td>
<td align="left">Alderaan</td>
</tr>
<tr class="even">
<td align="left">Ayla Secura</td>
<td align="left">Ryloth</td>
</tr>
</tbody>
</table>
</div>
<div style="clear: both;">

</div>
<p>When you run the code below you’ll see that <strong>left_join</strong> is very thorough and adds each additional homeworld it finds for <em>C-3PO</em> as a new row in the joined table.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new tables </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>starwars_heights <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Greedo&quot;</span>), </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">height  =</span> <span class="fu">c</span>(<span class="dv">172</span>, <span class="dv">167</span>, <span class="dv">202</span>, <span class="dv">150</span>, <span class="dv">173</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>starwars_homeworlds <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Luke Skywalker&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;C-3PO&quot;</span>, <span class="st">&quot;Darth Vader&quot;</span>, <span class="st">&quot;Leia Organa&quot;</span>, <span class="st">&quot;Ayla Secura&quot;</span>), </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">homeworld =</span> <span class="fu">c</span>(<span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Tantive IV&quot;</span>, <span class="st">&quot;Tatooine&quot;</span>, <span class="st">&quot;Alderaan&quot;</span>, <span class="st">&quot;Ryloth&quot;</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the tables together by Star Wars character name</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>height_and_homeworld <span class="ot">&lt;-</span> <span class="fu">left_join</span>(starwars_heights, starwars_homeworlds)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check number of rows</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(height_and_homeworld)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>height_and_homeworld</span></code></pre></div>
<p><br></p>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">height</th>
<th align="left">homeworld</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Luke Skywalker</td>
<td align="right">172</td>
<td align="left">Tatooine</td>
</tr>
<tr class="even">
<td align="left">C-3PO</td>
<td align="right">167</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">C-3PO</td>
<td align="right">167</td>
<td align="left">Tantive IV</td>
</tr>
<tr class="even">
<td align="left">Darth Vader</td>
<td align="right">202</td>
<td align="left">Tatooine</td>
</tr>
<tr class="odd">
<td align="left">Leia Organa</td>
<td align="right">150</td>
<td align="left">Alderaan</td>
</tr>
<tr class="even">
<td align="left">Greedo</td>
<td align="right">173</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="blockquote">
<p>This results in a table with one extra row than we started with in our heights table. So growing table sizes are a sign of duplicate records when using <strong>left_join()</strong>.</p>
<p>In practice, when you see this you’ll want to investigate why one of your tables has duplicate entries, especially if the observations for the two rows are different – as it was for <em>C-3PO’s</em> homeworld.</p>
<p>Are there really two different Star Wars characters named <em>C-3PO</em>, or did someone make two different guesses about the droid’s homeworld? Or maybe the data simply has a mistake? It happens.</p>
</div>
</p>
</div>
</div>
</details>
<style type="text/css"> 
.table {width: auto;} 
</style>
</div>
</div>
<div id="back-to-the-scrap-yard" class="section level2 unnumbered">
<h2>Back to the scrap yard</h2>
<hr class="hrlvl2">
<p>Let’s apply our new <code>left_join()</code> skills to the scrap data.</p>
<p>First, let’s load the full scrap data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the larger scrap database</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.app/data/starwars_scrap_jakku_full.csv&quot;</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># what units types are in the data? </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(scrap, units)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   units      
##   &lt;chr&gt;      
## 1 Cubic Yards
## 2 Items      
## 3 Tons</code></pre>
<div id="join-the-conversion-table-to-scrap" class="section level3 unnumbered">
<h3>Join the conversion table to scrap</h3>
<p>Look at the tables. What columns in both tables do we want to join <strong>by</strong>?</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(scrap)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(convert)</span></code></pre></div>
<p>Let’s join by <code>item</code> and <code>units</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the scrap to the conversion table</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">left_join</span>(scrap, convert, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;item&quot;</span>  <span class="ot">=</span> <span class="st">&quot;item&quot;</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;units&quot;</span> <span class="ot">=</span> <span class="st">&quot;units&quot;</span>))</span></code></pre></div>
<p><br></p>
<blockquote>
<p><strong>Want to save on typing?</strong></p>
</blockquote>
<p><code>left_join()</code> will automatically search for matching columns if you don’t use the <code>by=</code> argument. So if you know 2 tables share a column name you don’t have to specify how to join them. The code below does the same as above.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">left_join</span>(scrap, convert)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scrap, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 8
##   receipt_date item                  origin desti…¹ amount units price…² pound…³
##   &lt;chr&gt;        &lt;chr&gt;                 &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 4/1/2013     Bulkhead              Crate… Raiders   4017 Cubi…   1005.     321
## 2 4/2/2013     Starship sensor array Outsk… Trade …   1249 Cubi…   1129.     637
## 3 4/3/2013     Starship sensor array Outsk… Niima …   4434 Cubi…   1129.     637
## 4 4/4/2013     Hull Panel            Crate… Raiders    286 Cubi…    843.     641
## # … with abbreviated variable names ¹​destination, ²​price_per_pound,
## #   ³​pounds_per_unit</code></pre>
<p><br></p>
<div id="help" class="section level4 unnumbered quiz">
<h4><strong>Help!</strong></h4>
<p>For more details on the <strong>join</strong> family of functions, you can type <code>?left_join</code> to see all the arguments and options.
<br></p>
</div>
</div>
</div>
<div id="total-pounds-per-shipment" class="section level2 unnumbered">
<h2>Total pounds per shipment</h2>
<hr class="hrlvl2">
<p>Let’s <code>mutate()</code>!</p>
<p>Now that we have pounds per unit we can use <code>mutate</code> to calculate the total pounds for each shipment.</p>
<p><strong>Fill in the blank</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">mutate</span>(scrap, <span class="at">total_pounds =</span> amount <span class="sc">*</span>  ___________ )</span></code></pre></div>
<details>
<summary class="btn_code_blue">
<em>Show code</em>
</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">mutate</span>(scrap, <span class="at">total_pounds =</span> amount <span class="sc">*</span> pounds_per_unit)</span></code></pre></div>
</details>
</div>
<div id="total-price-per-shipment" class="section level2 unnumbered">
<h2>Total price per shipment</h2>
<div id="explore" class="section level3 unnumbered tip">
<h3><i class="fa fa-user-astronaut" style="color: green;"></i> Explore!</h3>
<ul class="nav nav-pills" id="myTab" role="tablist" style="margin-top: 18px;">
<li class="nav-item active">
<a class="nav-link" id="totalprice-tab" data-toggle="tab" href="#totalprice" role="tab" aria-controls="totalprice" aria-selected="true">Total price</a>
</li>
<li class="nav-item">
<a class="nav-link" id="showhint-tab" data-toggle="tab" href="#showhint" role="tab" aria-controls="showhint" aria-selected="false">Show hint</a>
</li>
<li class="nav-item">
<a class="nav-link" id="showcode-tab" data-toggle="tab" href="#showcode" role="tab" aria-controls="showcode" aria-selected="false">Show code</a>
</li>
</ul>
<div id="myTabContent" class="well tab-content" style="background-color: white;">
<div id="totalprice" class="tab-pane fade active in" role="tabpanel" aria-labelledby="totalprice-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each shipment.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">
# Calculate the total price for each shipment
scrap <- mutate(scrap, credits = ________ * ________ )
         
</pre>
</div>
<div id="showhint" class="tab-pane fade" role="tabpanel" aria-labelledby="showhint-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">
# Calculate the total price for each shipment
scrap <- mutate(scrap, credits = total_pounds  * ________ )

</pre>
</div>
<div id="showcode" class="tab-pane fade" role="tabpanel" aria-labelledby="showcode-tab">
<h4>
Total price
</h4>
<p>We need to do some serious multiplication. We now have the total amount shipped in pounds, and the price per pound, but we want to know the total price for each transaction.</p>
<p>How do we calculate that?</p>
<pre class="sourceCode r">
# Calculate the total price for each shipment
scrap <- mutate(scrap, credits = total_pounds * price_per_pound)
         
</pre>
</div>
</div>
</div>
<p><br></p>
<div id="price-per-item" class="section level3 unnumbered">
<h3>Price$ per item</h3>
<p><strong>Great!</strong></p>
<p>Let’s add one last column. We can divide the shipment’s <em>credits</em> by the <em>amount</em> of items to get the <code>price_per_unit</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the price per unit</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>scrap <span class="ot">&lt;-</span> <span class="fu">mutate</span>(scrap, <span class="at">price_per_unit =</span> credits <span class="sc">/</span> amount)</span></code></pre></div>
<p><br></p>
</div>
</div>
</div>
<div id="summarize" class="section level1" number="4">
<h1><span class="header-section-number">4</span> <code>summarize()</code></h1>
<hr>
<p><img src="../images/summarize_diagram.png" width="590" /></p>
<p><code>summarize()</code> uses summary functions <code>mean()</code> or <code>sum()</code> to collapse the data down to a single summary row. To get started we’ll need some summary functions like <code>sum()</code>, <code>mean()</code>, <code>min()</code>, and <code>max()</code>.</p>
<div id="sum" class="section level2 unnumbered">
<h2><code>sum()</code></h2>
<p>Use <code>summarize()</code> and <code>sum()</code> to find the total credits of all the scrap combined.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(scrap, <span class="at">total_credits =</span> <span class="fu">sum</span>(credits))</span></code></pre></div>
</div>
<div id="mean" class="section level2 unnumbered">
<h2><code>mean()</code></h2>
<p>Use <code>summarize()</code> and <code>mean()</code> to calculate the <em>mean</em> <code>price_per_pound</code> in the scrap report.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(scrap, <span class="at">mean_price =</span> <span class="fu">mean</span>(price_per_pound, <span class="at">na.rm =</span> T))</span></code></pre></div>
<p><br></p>
<div id="note" class="section level3 unnumbered note">
<h3>Note</h3>
<p><strong>What’s the average of missing data?</strong> I don’t know.</p>
<p>Did you see the <code>na.rm = TRUE</code> inside the <code>mean()</code> function. This tells R to ignore empty cells or missing values that show up in R as <code>NA</code>. If you leave <code>na.rm</code> out, the <em>mean</em> function will return ‘NA’ if it finds a missing value anywhere in the data.</p>
</div>
</div>
<div id="median" class="section level2 unnumbered">
<h2><code>median()</code></h2>
<p>Use summarize to calculate the <em>median</em> price_per_pound in the scrap report.</p>
<p><code>summarize(scrap, median_price = median(price_per_pound, na.rm = TRUE))</code></p>
</div>
<div id="max" class="section level2 unnumbered">
<h2><code>max()</code></h2>
<p>Use summarize to calculate the <em>maximum</em> price per pound any scrapper got for their scrap.</p>
<p><code>summarize(scrap, max_price = max(price_per_pound, na.rm = TRUE))</code></p>
</div>
<div id="min" class="section level2 unnumbered">
<h2><code>min()</code></h2>
<p>Use summarize to calculate the <em>minimum</em> price per pound any scrapper got for their scrap.</p>
<p><code>summarize(scrap, min_price = min(price_per_pound, na.rm = TRUE))</code></p>
</div>
<div id="sd" class="section level2 unnumbered">
<h2><code>sd()</code></h2>
<p>What is the <em>standard deviation</em> of the credits?</p>
<p><code>summarize(scrap, stdev_credits = sd(credits))</code></p>
</div>
<div id="quantile" class="section level2 unnumbered">
<h2><code>quantile()</code></h2>
<p><em>Quantiles</em> are useful for finding the upper or lower range of a column. Use the <code>quantile()</code> function to find the the 5th and 95th quantile of the prices.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(scrap, </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">price_5th_pctile  =</span> <span class="fu">quantile</span>(price_per_pound, <span class="fl">0.05</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">price_95th_pctile =</span> <span class="fu">quantile</span>(price_per_pound, <span class="fl">0.95</span>))</span></code></pre></div>
<p><strong>Hint:</strong> Add <code>na.rm = T</code> to <code>quantile()</code>.</p>
</div>
<div id="n" class="section level2 unnumbered">
<h2><code>n()</code></h2>
<p><code>n()</code> stands for <em>count</em>.</p>
<p>Use summarize and <code>n()</code> to count the number of scrap records.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(scrap, <span class="at">scrap_records =</span> <span class="fu">n</span>())</span></code></pre></div>
<p><br></p>
<div id="explore-1" class="section level3 unnumbered tip">
<h3>Explore!</h3>
<ol style="list-style-type: decimal">
<li>Create a summary of the scrap data that includes 3 of the summary functions above. The following is one example.</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>scrap_summary <span class="ot">&lt;-</span> <span class="fu">summarize</span>(scrap, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">max_credits      =</span> __________,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">weight_90th_pct  =</span> <span class="fu">quantile</span>(total_pounds, <span class="fl">0.90</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">count_records    =</span> __________,</span></code></pre></div>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>Use summarize and <code>n()</code> to count the number of reported scrap records going to <code>Niima outpost</code>.</li>
</ol>
<p><strong>Hint:</strong> Use <code>filter()</code> first.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>niima_scrap <span class="ot">&lt;-</span> <span class="fu">filter</span>(scrap, destination <span class="sc">==</span> <span class="st">&quot;Niima Outpost&quot;</span>) </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>niima_scrap <span class="ot">&lt;-</span> <span class="fu">summarize</span>(niima_scrap, <span class="at">scrap_records =</span> <span class="fu">n</span>())</span></code></pre></div>
</div>
<p><br></p>
<blockquote>
<h4 style="margin-top: 12px;">
<strong>How about a count of the records for every city?</strong>
</h4>
<p>It’d sure be nice if we could easily count the records for every city.</p>
</blockquote>
</div>
</div>
<div id="group_by-category" class="section level1" number="5">
<h1><span class="header-section-number">5</span> <code>group_by()</code> category</h1>
<hr>
<p><code>group_by()</code> gives us the power to calculate separate results for each category in the data. This could be the average concentration at each of your monitoring sites, or the total emissions of a pollutant from each facility or stack.</p>
<div id="bargain-hunters" class="section level3 unnumbered">
<h3>Bargain hunters</h3>
<p>Who’s selling goods for cheap? Use <code>group_by</code> with the column <em>origin</em> to find the <code>mean(price_per_pound)</code> at each Origin City.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>scrap_means <span class="ot">&lt;-</span> <span class="fu">group_by</span>(scrap, origin) </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>scrap_means <span class="ot">&lt;-</span> <span class="fu">summarize</span>(scrap_means,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean_price =</span> <span class="fu">mean</span>(price_per_pound, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><br></p>
<details>
<summary class="btn_code_blue">
Rounding digits
</summary>
<div class="note" style="margin-top: -7px;">
<p>
<div id="rounding" class="section level3 unnumbered">
<h3>Rounding</h3>
<p>You can round the prices to a certain number of digits using the <code>round()</code> function. We can finish by adding the <code>arrange()</code> function to sort the table by our new column.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>scrap_means <span class="ot">&lt;-</span> <span class="fu">summarize</span>(scrap,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean_price       =</span> <span class="fu">mean</span>(price_per_pound, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mean_price_round =</span> <span class="fu">round</span>(mean_price, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>scrap_means <span class="ot">&lt;-</span> <span class="fu">arrange</span>(scrap_means, mean_price_round)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>scrap_means <span class="ot">&lt;-</span> <span class="fu">ungroup</span>(scrap_means)</span></code></pre></div>
<p><br></p>
</div>
<div id="note-1" class="section level3 unnumbered">
<h3>Note</h3>
<p>The <code>round()</code> function in R does not automatically round values ending in 5 upwards. It uses <em>scientific rounding</em>, which rounds values ending in 5 to the nearest <strong>even</strong> number. So 2.5 rounded to the nearest even number rounds down to <strong>2</strong>, and 3.5 rounded to the nearest even number rounds up <strong>4</strong>.</p>
</p>
</div>
</div>
</details>
</div>
<div id="busiest-scrap-city" class="section level2 unnumbered">
<h2>Busiest scrap city</h2>
<p>So who’s making the most transactions? Try using <code>group_by</code> with the column <em>origin</em> to count the number of scrap records at each city. We can use the tiny-tiny function <code>n()</code> to count the number of rows.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>scrap_counts <span class="ot">&lt;-</span> <span class="fu">group_by</span>(scrap, origin)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>scrap_counts <span class="ot">&lt;-</span> <span class="fu">summarize</span>(scrap, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">origin_count =</span> <span class="fu">n</span>())</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>scrap_counts <span class="ot">&lt;-</span> <span class="fu">ungroup</span>(scrap_counts)</span></code></pre></div>
<div id="spock-tip" class="section level3 unnumbered note">
<h3><i class="fas fa-hand-spock"></i> Spock-tip!</h3>
<p>Ending with <code>ungroup()</code> is good practice. This prevents your data from staying grouped after the summarizing has been completed.</p>
</div>
</div>
</div>
<div id="save-files" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Save files</h1>
<hr>
<p>Let’s save the mean price table we created to a <em>CSV</em>. That way we can send it to Rey. To save a table we can use the <code>write_csv()</code> function from our favorite <strong>readr</strong> package.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Write the file to your results folder</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(scrap_means, <span class="st">&quot;results/prices_by_origin.csv&quot;</span>)</span></code></pre></div>
<p><br></p>
<div class="red-note">
<h3 style="margin-top: 12px; color: white; margin-top: -6px; font-size: 22px;">
<i class="fas fa-exclamation-triangle"></i> Note
</h3>
<p>By default, R will overwrite a file if the file already exists in the same folder. To be safe, save processed data to a new folder called <code>results/</code> and not to your raw <code>data/</code> folder.</p>
</div>
<div id="save-results" class="section level2 unnumbered">
<h2>Save results</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(scrap, <span class="st">&quot;results/scrap_day2.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="a-sickness-grows" class="section level1" number="7">
<h1><span class="header-section-number">7</span> A sickness grows…</h1>
<hr>
<blockquote>
<p><strong>Your turn!</strong> Practicing joining and summarizing</p>
</blockquote>
<style>

.button-dl {
    padding: 7px;
    padding-right: 15px;
    padding-left: 14px;
    color: #254d67;
    background-color: #e8e8e8;
    margin-left: 12px;
    margin-top: 16px;
    margin-bottom: 6px;
    position: relative;
    z-index: 99;
    border-color: #a3b6c6;
    border-width: 1px;
    border-radius: 2px;
}
</style>
<p>A sickness is spreading throughout the galaxy. To slow its spread should we restrict travel to some planets? Or is it too late?</p>
<p>Follow the steps below to collect the current disease records and summarize cases by planet. To do so, you’ll need to join the disease records to a separate table with the planet information.</p>
<div id="create-a-new-project" class="section level3 unnumbered">
<h3>Create a new project</h3>
<p>Go to <code>File</code> &gt; <code>New Project...</code> &gt; <code>New Directory</code> &gt; <code>New Project</code></p>
<ul>
<li>Name the project <code>sickness</code></li>
</ul>
</div>
<div id="get-the-disease-data" class="section level2 unnumbered">
<h2>Get the disease data</h2>
<p><a href="https://mn-r.netlify.app/data/disease_records.xlsx"><button class="button-dl" download="disease_records.xlsx">
Download (XLSX)   <i class="fa fa-download"></i>
</button></a></p>
<p>Click the button above to download the Excel file <em>disease_records.xlsx</em></p>
<ul>
<li>Save the file to your project folder</li>
</ul>
<p>If the file was automatically downloaded to your <em>Downloads</em> folder, move or copy the file to your project folder.</p>
<div id="load-the-data" class="section level3 unnumbered">
<h3>Load the data</h3>
<blockquote>
<p>Create a new R script and save it as <em>disease_report.R</em></p>
</blockquote>
<p>To load the data, use <code>read_xlsx()</code> from the <code>readxl</code> library to load the disease data into R. Add the code below to your R script and ensure the file name matches the file added to your project folder.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>records <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">&quot;disease_records.xlsx&quot;</span>)</span></code></pre></div>
<details>
<summary class="btn_code_blue">
<strong>Plan B</strong> - Read the data from CSV
</summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>records <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://mn-r.netlify.app/data/disease_records.csv&quot;</span>)</span></code></pre></div>
</details>
</div>
<div id="explore-2" class="section level3 unnumbered">
<h3>Explore</h3>
<p>Use <code>glimpse()</code> to view a summary of the data columns.</p>
</div>
</div>
<div id="planet-data" class="section level2 unnumbered">
<h2>Planet data</h2>
<p>To find the planets these records are associated with, we will need to join the records data to the <code>starwars</code> data set in the package <code>dplyr</code>.</p>
<p>To load the planet data, add the following to your R script:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>people <span class="ot">&lt;-</span> starwars</span></code></pre></div>
<div id="explore-3" class="section level3 unnumbered">
<h3>Explore</h3>
<blockquote>
<p>What is the number of distinct values in the <code>homeworld</code> column of the <em>people</em> data set?</p>
</blockquote>
<ul>
<li>Use <code>n_distinct()</code> to count the number of ‘homeworld’ planets.</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(people, <span class="at">n_planets =</span> <span class="fu">n_distinct</span>( _______ ))</span></code></pre></div>
<blockquote>
<p>What are they? Print the unique values of the <code>homeworld</code> column in the <em>people</em> data set:</p>
</blockquote>
<ul>
<li>Use <code>distinct()</code> to show the unique values of <code>homeworld</code> column.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(people, ________ )</span></code></pre></div>
<blockquote>
<p>Is one of the homeworlds <code>NA</code>? What does the ‘NA’ mean here?</p>
</blockquote>
<p><br></p>
</div>
<div id="join-the-homeworld-planets-to-disease-records" class="section level3 unnumbered">
<h3>Join the homeworld planets to disease records</h3>
<p>Complete the script below to join the two data sets.</p>
<ol style="list-style-type: decimal">
<li>In the 1st blank, with the name of the data you want to join to <code>records</code>.<br />
</li>
<li>In the 2nd blank, put the column name found in both data sets that you want to join <strong>by</strong> in quotes <code>""</code>. This is the column that both tables have in common.</li>
</ol>
<blockquote>
<p>You can run <code>names(records)</code> to view the column names in the dataframe.</p>
</blockquote>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>joined <span class="ot">&lt;-</span> <span class="fu">left_join</span>(records, _______ , </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by =</span> <span class="st">&quot;______&quot;</span> )</span></code></pre></div>
</div>
<div id="summarize-the-records-by-homeworld" class="section level3 unnumbered">
<h3>Summarize the records by homeworld</h3>
<p>Use <code>group_by()</code> to group the records by the planet column:<code>homeworld</code></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>joined <span class="ot">&lt;-</span> <span class="fu">group_by</span>(joined, homeworld) </span></code></pre></div>
<p><br></p>
<p>Now you can use the <code>n()</code> function to find the number of records by <code>homeworld</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>planet_totals <span class="ot">&lt;-</span> <span class="fu">summarize</span>(joined, <span class="at">cases =</span> _______ )</span></code></pre></div>
</div>
<div id="restricted-travel" class="section level3 unnumbered">
<h3>Restricted travel?</h3>
<blockquote>
<p>Which planet has the most cases?</p>
</blockquote>
<p>Use <code>arrange()</code> and <code>desc()</code> to sort the results by the <code>cases</code> column.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>planet_totals <span class="ot">&lt;-</span> <span class="fu">arrange</span>(planet_totals, ________ )</span></code></pre></div>
<p><br></p>
<blockquote>
<p>How many planets are off limits?</p>
</blockquote>
<p>The health liaison has recommended cutting off travel to any planet with more than 20 cases.</p>
<p>Use <code>filter()</code> to keep only the planets in the data with more than 20 in the <code>cases</code> column.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>off_limits <span class="ot">&lt;-</span> <span class="fu">filter</span>(planet_totals, ________ )</span></code></pre></div>
<p><br></p>
</div>
<div id="save" class="section level3 unnumbered">
<h3>Save</h3>
<ol style="list-style-type: decimal">
<li>Use <code>write_csv()</code> to save the planet list as <strong>“restricted_planets.csv”</strong>.<br />
</li>
<li>Save your R script.<br />
</li>
<li>Clap 3 times for your great work.<br />
</li>
<li>When ready, return to your <code>jakku</code> project.</li>
</ol>
<p><br></p>
</div>
<div id="return-to-homebase" class="section level3 unnumbered">
<h3><i class="fa fa-rocket" aria-hidden="true"></i> Return to <a href="../post/day-2.html">Homebase</a></h3>
<p><br></p>
</div>
</div>
</div>
